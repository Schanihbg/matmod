#+TITLE: Kmom 02: Monte Carlo metoden och Centrala gränsvärdessatsen
#+AUTHOR: Henrik Frediksson och Thomas Sievert


* Monte-Carlo metoden

I detta kursmoment så kommer vi gå igenom hur man kan uppskatta
integraler.

Om =f(x)= är en funktion som är icke-negativ på intervallet =[a,b]= så
kan vi beräkna arean =A= av området mellan funktion och =x=-axeln med
integralen

[[integral.png]]

där =F(x)= uppfyller =F'(x) = f(x)=

Dock så är det inte alltid möjligt att finna =F(x)= så att vi kan
beräkna integralen.

/Monte Carlo/-metoden är en probabilistisk metod som uppskattar värdet
på en integral. Låt =c= vara det största funktionsvärdet av =f(x)= på
intervallet =[a,b]=. Då gäller det att

[[integral_est.png]]

dvs arean =A= är mindre än arean av den rektangel som innesluter omsluter området

#+begin_src python :session
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle

a = 0
b = 4
x = np.linspace(a,b,1000)
y = np.absolute(x*np.exp(-np.sin(x)**2))

plt.plot(x, y)

currentAxis = plt.gca()
currentAxis.add_patch(Rectangle((0, 0), 4, 3.22, facecolor="blue", alpha = 0.1))
plt.savefig('area.png')
plt.grid(True)
plt.show()

#+end_src

#+RESULTS:
: Rectangle(xy=(0, 0), width=4, height=3.22, angle=0)

[[area.png]]

Monte-Carlo metoden fungerar på följande sätt. Betrakta händelsen =I=
att en slumpvis vald punkt inuti rektangeln ligger under grafen =y = f(x)=
- Välj =n= punkter slumpvis som ligger inuti boxen.
- Beräkna antalet punkter som ligger under grafen =y = f(x)=. Beteckna detta tal
  med =m=
- Då =n= växer så gäller det att =m/n= går mot =Pr(U)=

I figuren nedan är 200 slumpvis valda punkter plottade. De blå
punkterna ligger under grafen och de oranga ligger över grafen.

[[montecarlo.png]]

När vi vet sannolikheten för att en slumpvis vald punkt ligger under
grafen Vi kan nu uppskatta integralen enligt

[[approximation.png]]


** Uppgifter

Ni ska skapa en sida där följande ska ingå.

1. Välj en funktion =f(x)= och ett intervall =[a,b]= sådan att =f(x)
   >= 0= in intervallet =[a,b]=
2. Plotta grafen =y = f(x)= i intervallet =[a,b]=
3. Använd Monte-Carlo metoden för att beräkna arean av området mellan
   =x=-axeln och kurvan för olika värden =n= (3-4 stycken).
4. För varje värde på =n=, plotta de slumpade punkterna i ny figur
   tilsammans med grafen =y=. I figuren ska det framgå
   vilka av punkterna som ligger under grafen och vilka som ligger över

5. Avgör med hjälp av Monte-Carlo metoden ett värde på arean.


* Centrala gränsvärdensatsen
